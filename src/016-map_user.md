# map_user.hsp


## 自店でアイテムが交換されるとき、既に入っているアイテムの個数を上書きしてしまう問題
787 名前：名無しさん＠お腹いっぱい。　[sage]　投稿日：2011/04/11(月) 00:54:19.99 ID:1JzBSPXT
~>>735-737
報告ありがとうございます。修正しました。多分これで大丈夫だと思います。
店の金庫のバグは公式でも起きるっぽいです。一応解決方法を下に。

ttp://www1.axfc.net/uploader/Sc/so/223518.zip&key=elona_ore_hack
・「a」キーからの罠解体時、罠を起動してしまうと中断するようにした。
　経験値も少しですが入ります。
・自店で物が交換される処理時、金庫に候補になるアイテムが既に入っていると
　場合によっては既に入っているアイテムの個数が０に上書きされてしまうバグを修正。
・何もいない所に聴診器を使うと落ちるバグを修正。

金庫バグ解決方法(逆コンパイルソース)
130274行と130275行の間に
nostack = 1
を挿入。
130280行と130281行の間に
item_stack -1, ci
を挿入。

## 自店で売れた焚き火のSEが残り続ける問題
Ver1.22自分の店に焚き火を置き、売れて無くなっても焚き火のSEが残りっぱなしになる。もう一度焚き火を置いて拾えばSEは消える。 -- 2010-09-17 (金) 18:50:07


## 雇用できる使用人が日によって完全固定されない問題
isethire(hire)のあたり
#br
日付 + cntでrandomizeしているが例によってexrandを固定してないので店主の種類がランダムになってしまう
exrand_randomize 日付 + cntしておいて
規模を設定する前でexrand_randomize_by_timeしておく
#br
名前が同じユニットを生成するとならchara_vanquishしているが存在状態をチェックしていないので
名前を変更せずに解雇すると再び雇えないことがある
存在状態が0じゃなければという条件を追加しておく

